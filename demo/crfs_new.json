{
  "name" : "Chunking with CRFs",
  "cells" : [ {
    "id" : 0,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "import ml.wolfe.term.LearningObjective._\n@domain case class Input(words: IndexedSeq[String])\ntype Output = IndexedSeq[String]\ntype Instance = (Input, Output)\n//  val conlltrain = CoNLL2000.train.take(2).toIndexedSeq\n//  val conlltest = CoNLL2000.test.take(2).toIndexedSeq\n  val train = Seq(\n      Input(IndexedSeq(\"Welcome\", \"to\", \"Wolfe\", \"!\")) -> IndexedSeq(\"O\", \"O\", \"WOLFE\", \"omg\"),\n    Input(IndexedSeq(\"Wolfe\", \"is\", \"great\", \"!\")) -> IndexedSeq(\"WOLFE\", \"O\", \"O\", \"omg\")\n  )\n  val test = Seq(\n    Input(IndexedSeq(\"I\", \"love\", \"Wolfe\", \".\")) -> IndexedSeq(\"O\", \"O\", \"WOLFE\", \"omg\")\n  )\nval sentences = train ++ test\nval labels = sentences.flatMap(_._2).distinct\nval words = train.flatMap(_._1.words).distinct\nwords",
      "extraFields" : {
        "aggregatedCells" : "[]"
      },
      "outputFormat" : "<div class=\"string-result\"><div class=\"asIterable List\"><span class=\"typeName\">List</span>\n<ol start=\"0\" class=\"fields\">\n  <li class=\"fieldValue\"><span class=\"asString String\">Welcome</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">to</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">Wolfe</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">!</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">is</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">great</span></li>\n</ol>\n</div></div>"
    }
  }, {
    "id" : 1,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "val maxLength = sentences.map(_._2.length).max\nval maxFeats = 20000\n\nimplicit val Thetas = Vectors(maxFeats)\nimplicit val Labels = labels.toDom\nimplicit val Words = words.toDom withOOV \"[OOV]\"\n\nimplicit val Inputs = Input.Objects(Seqs(Words, 0, maxLength))\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\nimplicit val Instances = Pairs(Inputs, Outputs)\nimplicit val index = new SimpleIndex()\n\nval mpParams = MaxProductParameters(iterations = 1)\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\n\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x.words(i), y(i))\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\n\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.words.length)(i => t dot bias(y, i)) +\n    sum(0 until x.words.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.words.length - 1)(i => t dot pair(y, i))\n} subjectTo (y.length === x.words.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\n//val thetaStar = feature('word, \"Wolfe\", \"WOLFE\")\n\n  def predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\n  val result = predict(Inputs.Const(test.head._1)).evalResult()\nD3FG.display(result.factorGraphs.head)\n",
      "extraFields" : {
        "aggregatedCells" : "[\"import ml.wolfe.term.LearningObjective._\\n@domain case class Input(words: IndexedSeq[String])\\ntype Output = IndexedSeq[String]\\ntype Instance = (Input, Output)\\n//  val conlltrain = CoNLL2000.train.take(2).toIndexedSeq\\n//  val conlltest = CoNLL2000.test.take(2).toIndexedSeq\\n  val train = Seq(\\n      Input(IndexedSeq(\\\"Welcome\\\", \\\"to\\\", \\\"Wolfe\\\", \\\"!\\\")) -> IndexedSeq(\\\"O\\\", \\\"O\\\", \\\"WOLFE\\\", \\\"omg\\\"),\\n    Input(IndexedSeq(\\\"Wolfe\\\", \\\"is\\\", \\\"great\\\", \\\"!\\\")) -> IndexedSeq(\\\"WOLFE\\\", \\\"O\\\", \\\"O\\\", \\\"omg\\\")\\n  )\\n  val test = Seq(\\n    Input(IndexedSeq(\\\"I\\\", \\\"love\\\", \\\"Wolfe\\\", \\\".\\\")) -> IndexedSeq(\\\"O\\\", \\\"O\\\", \\\"WOLFE\\\", \\\"omg\\\")\\n  )\\nval sentences = train ++ test\\nval labels = sentences.flatMap(_._2).distinct\\nval words = train.flatMap(_._1.words).distinct\\nwords\"]"
      },
      "outputFormat" : "<div class=\"string-result\"><div id=\"fg-2288716805946844849\"><div class=\"playbtn\">Play</div><svg class=\"factorgraph\" width=\"650\" height=\"250\" style=\"overflow: visible;\"><defs><marker id=\"markerArrow0\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow1\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow2\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow3\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow4\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow5\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow6\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow7\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow8\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow9\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow10\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow11\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow12\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow13\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow14\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker></defs><line class=\"link\" x1=\"472.1702454977046\" y1=\"25\" x2=\"393.13790611967534\" y2=\"25\"></line><line class=\"link\" x1=\"168.1714373195935\" y1=\"25\" x2=\"233.25216294568827\" y2=\"25\"></line><line class=\"link\" x1=\"115.09899969211148\" y1=\"165.19714673100196\" x2=\"182.42100233229706\" y2=\"172.31274654253968\"></line><line class=\"link\" x1=\"349.62405635310034\" y1=\"193.47610572817126\" x2=\"299.6531122782083\" y2=\"225\"></line><line class=\"link\" x1=\"444.32695661492676\" y1=\"25\" x2=\"393.13790611967534\" y2=\"25\"></line><line class=\"link\" x1=\"282.5909194831186\" y1=\"25\" x2=\"233.25216294568827\" y2=\"25\"></line><line class=\"link\" x1=\"142.60029249491342\" y1=\"225\" x2=\"182.42100233229706\" y2=\"172.31274654253968\"></line><line class=\"link\" x1=\"368.1889813329494\" y1=\"225\" x2=\"299.6531122782083\" y2=\"225\"></line><line class=\"link\" x1=\"319.93101374513645\" y1=\"25\" x2=\"393.13790611967534\" y2=\"25\"></line><line class=\"link\" x1=\"319.93101374513645\" y1=\"25\" x2=\"233.25216294568827\" y2=\"25\"></line><line class=\"link\" x1=\"199.91502921713084\" y1=\"96.07267432382862\" x2=\"233.25216294568827\" y2=\"25\"></line><line class=\"link\" x1=\"199.91502921713084\" y1=\"96.07267432382862\" x2=\"182.42100233229706\" y2=\"172.31274654253968\"></line><line class=\"link\" x1=\"232.09597833714682\" y1=\"225\" x2=\"182.42100233229706\" y2=\"172.31274654253968\"></line><line class=\"link\" x1=\"232.09597833714682\" y1=\"225\" x2=\"299.6531122782083\" y2=\"225\"></line><line class=\"link\" x1=\"551.8194725020961\" y1=\"225\" x2=\"605.247434469523\" y2=\"201.89208336211374\"></line><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(605.247434469523,201.89208336211374)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(393.13790611967534,25)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(233.25216294568827,25)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(182.42100233229706,172.31274654253968)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(299.6531122782083,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(472.1702454977046,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(168.1714373195935,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(115.09899969211148,165.19714673100196)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(349.62405635310034,193.47610572817126)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(444.32695661492676,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(282.5909194831186,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(142.60029249491342,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(368.1889813329494,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(319.93101374513645,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(199.91502921713084,96.07267432382862)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(232.09597833714682,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(551.8194725020961,225)\"></path><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(605.247434469523,201.89208336211374)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(393.13790611967534,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(233.25216294568827,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(182.42100233229706,172.31274654253968)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(299.6531122782083,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(472.1702454977046,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(168.1714373195935,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(115.09899969211148,165.19714673100196)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(349.62405635310034,193.47610572817126)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(444.32695661492676,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(282.5909194831186,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(142.60029249491342,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(368.1889813329494,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(319.93101374513645,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(199.91502921713084,96.07267432382862)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(232.09597833714682,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(551.8194725020961,225)\" style=\"font-size: 15px;\"></text></svg></div>\n\n <link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/stylesheets/factorgraph/fg.css\">\n\n<script type=\"text/javascript\">\n             var fgScriptLocation;\n             if (typeof fgScriptLocation === 'undefined') {\n                fgScriptLocation = \"/assets/javascripts/factorgraph/fg.js\";\n                head.js(fgScriptLocation);\n             }\n             head.ready(function() {\n                var fgData = {\"width\": 650,\n                              \"height\": 250,\n                              \"graph\": {\"nodes\": [{\"x\": 186.49840429220376,\n                                                   \"y\": 204.11920126403587,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 456.3803815326106,\n                                                   \"y\": 28.182380860699176,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 47.601531653254646,\n                                                   \"y\": 131.10517835609818,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 337.7501689749705,\n                                                   \"y\": 375.0022189059735,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 545.8295469967181,\n                                                   \"y\": 199.9797521455839,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(0)), SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(1)), SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(2)), SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(3)), SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(0)), SeqAtom(_hidden,(0 until 4 - 1)(0) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(1)), SeqAtom(_hidden,(0 until 4 - 1)(1) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(2)), SeqAtom(_hidden,(0 until 4 - 1)(2) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"log(I(LengthAtom(_hidden) === 4))\"}],\n                                        \"links\": [{\"target\": 1, \"source\": 5},\n                                                  {\"target\": 2, \"source\": 6},\n                                                  {\"target\": 3, \"source\": 7},\n                                                  {\"target\": 4, \"source\": 8},\n                                                  {\"target\": 1, \"source\": 9},\n                                                  {\"target\": 2, \"source\": 10},\n                                                  {\"target\": 3, \"source\": 11},\n                                                  {\"target\": 4, \"source\": 12},\n                                                  {\"target\": 1, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 15},\n                                                  {\"target\": 4, \"source\": 15},\n                                                  {\"target\": 0, \"source\": 16}]},\n                              \"schedule\": [[{\"edge\": 0,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 0,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>-0.1</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\"}]]};\n                FG.create(\"fg-2288716805946844849\", fgData);\n             });\n    </script></div>"
    }
  }, {
    "id" : 2,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "def skip(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+2))\ndef model2(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.words.length)(i => t dot bias(y, i)) +\n    sum(0 until x.words.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.words.length - 1)(i => t dot pair(y, i)) +\n    sum(0 until x.words.length - 2)(i => t dot skip(y, i))\n} subjectTo (y.length === x.words.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar2 = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model2(t))) using adaGrad(params)\n//val thetaStar = feature('word, \"Wolfe\", \"WOLFE\")\n\n  def predict2(x:Inputs.Term) = argmax(Outputs)(model2(Thetas.Const(thetaStar))(x))\n  val result2 = predict2(Inputs.Const(test.head._1)).evalResult()\nD3FG.display(result2.factorGraphs.head)\n",
      "extraFields" : {
        "aggregatedCells" : "[\"import ml.wolfe.term.LearningObjective._\\n@domain case class Input(words: IndexedSeq[String])\\ntype Output = IndexedSeq[String]\\ntype Instance = (Input, Output)\\n//  val conlltrain = CoNLL2000.train.take(2).toIndexedSeq\\n//  val conlltest = CoNLL2000.test.take(2).toIndexedSeq\\n  val train = Seq(\\n      Input(IndexedSeq(\\\"Welcome\\\", \\\"to\\\", \\\"Wolfe\\\", \\\"!\\\")) -> IndexedSeq(\\\"O\\\", \\\"O\\\", \\\"WOLFE\\\", \\\"omg\\\"),\\n    Input(IndexedSeq(\\\"Wolfe\\\", \\\"is\\\", \\\"great\\\", \\\"!\\\")) -> IndexedSeq(\\\"WOLFE\\\", \\\"O\\\", \\\"O\\\", \\\"omg\\\")\\n  )\\n  val test = Seq(\\n    Input(IndexedSeq(\\\"I\\\", \\\"love\\\", \\\"Wolfe\\\", \\\".\\\")) -> IndexedSeq(\\\"O\\\", \\\"O\\\", \\\"WOLFE\\\", \\\"omg\\\")\\n  )\\nval sentences = train ++ test\\nval labels = sentences.flatMap(_._2).distinct\\nval words = train.flatMap(_._1.words).distinct\\nwords\",\"val maxLength = sentences.map(_._2.length).max\\nval maxFeats = 20000\\n\\nimplicit val Thetas = Vectors(maxFeats)\\nimplicit val Labels = labels.toDom\\nimplicit val Words = words.toDom withOOV \\\"[OOV]\\\"\\n\\nimplicit val Inputs = Input.Objects(Seqs(Words, 0, maxLength))\\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\\nimplicit val Instances = Pairs(Inputs, Outputs)\\nimplicit val index = new SimpleIndex()\\n\\nval mpParams = MaxProductParameters(iterations = 1)\\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\\n\\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x.words(i), y(i))\\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\\n\\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\\n    sum(0 until x.words.length)(i => t dot bias(y, i)) +\\n    sum(0 until x.words.length)(i => t dot word(x, y, i)) +\\n    sum(0 until x.words.length - 1)(i => t dot pair(y, i))\\n} subjectTo (y.length === x.words.length) argmaxBy maxProduct(mpParams)\\n\\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\\n//val thetaStar = feature('word, \\\"Wolfe\\\", \\\"WOLFE\\\")\\n\\n  def predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\\n  val result = predict(Inputs.Const(test.head._1)).evalResult()\\nD3FG.display(result.factorGraphs.head)\\n\"]"
      },
      "outputFormat" : "<div class=\"string-result\"><div id=\"fg-4004503029736365988\"><div class=\"playbtn\">Play</div><svg class=\"factorgraph\" width=\"650\" height=\"250\" style=\"overflow: visible;\"><defs><marker id=\"markerArrow0\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow1\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow2\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow3\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow4\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow5\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow6\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow7\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow8\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow9\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow10\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow11\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow12\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow13\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow14\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow15\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow16\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow17\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow18\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker></defs><line class=\"link\" x1=\"164.94211131215914\" y1=\"118.24407805299974\" x2=\"230.4770244885474\" y2=\"95.2828773266892\"></line><line class=\"link\" x1=\"373.18091427323213\" y1=\"25\" x2=\"388.11865466122697\" y2=\"79.28982166771702\"></line><line class=\"link\" x1=\"369.2807119739698\" y1=\"225\" x2=\"318.7118799141134\" y2=\"225\"></line><line class=\"link\" x1=\"549.5562907505863\" y1=\"170.0676940013512\" x2=\"484.72956018247123\" y2=\"196.9889205007917\"></line><line class=\"link\" x1=\"197.54187212485442\" y1=\"34.73572441017928\" x2=\"230.4770244885474\" y2=\"95.2828773266892\"></line><line class=\"link\" x1=\"437.07921330087373\" y1=\"25\" x2=\"388.11865466122697\" y2=\"79.28982166771702\"></line><line class=\"link\" x1=\"253.13455129411585\" y1=\"225\" x2=\"318.7118799141134\" y2=\"225\"></line><line class=\"link\" x1=\"543.2282210295754\" y1=\"225\" x2=\"484.72956018247123\" y2=\"196.9889205007917\"></line><line class=\"link\" x1=\"305.1222859501996\" y1=\"64.24834046105026\" x2=\"230.4770244885474\" y2=\"95.2828773266892\"></line><line class=\"link\" x1=\"305.1222859501996\" y1=\"64.24834046105026\" x2=\"388.11865466122697\" y2=\"79.28982166771702\"></line><line class=\"link\" x1=\"352.47303545031644\" y1=\"150.97556304101383\" x2=\"388.11865466122697\" y2=\"79.28982166771702\"></line><line class=\"link\" x1=\"352.47303545031644\" y1=\"150.97556304101383\" x2=\"318.7118799141134\" y2=\"225\"></line><line class=\"link\" x1=\"410.64745637525374\" y1=\"225\" x2=\"318.7118799141134\" y2=\"225\"></line><line class=\"link\" x1=\"410.64745637525374\" y1=\"225\" x2=\"484.72956018247123\" y2=\"196.9889205007917\"></line><line class=\"link\" x1=\"257.4598647525662\" y1=\"170.5509239070662\" x2=\"230.4770244885474\" y2=\"95.2828773266892\"></line><line class=\"link\" x1=\"257.4598647525662\" y1=\"170.5509239070662\" x2=\"318.7118799141134\" y2=\"225\"></line><line class=\"link\" x1=\"453.73123861393475\" y1=\"124.0183711562202\" x2=\"388.11865466122697\" y2=\"79.28982166771702\"></line><line class=\"link\" x1=\"453.73123861393475\" y1=\"124.0183711562202\" x2=\"484.72956018247123\" y2=\"196.9889205007917\"></line><line class=\"link\" x1=\"77.5886526052345\" y1=\"25\" x2=\"25\" y2=\"25\"></line><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(25,25)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(230.4770244885474,95.2828773266892)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(388.11865466122697,79.28982166771702)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(318.7118799141134,225)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(484.72956018247123,196.9889205007917)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(164.94211131215914,118.24407805299974)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(373.18091427323213,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(369.2807119739698,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(549.5562907505863,170.0676940013512)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(197.54187212485442,34.73572441017928)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(437.07921330087373,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(253.13455129411585,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(543.2282210295754,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(305.1222859501996,64.24834046105026)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(352.47303545031644,150.97556304101383)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(410.64745637525374,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(257.4598647525662,170.5509239070662)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(453.73123861393475,124.0183711562202)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(77.5886526052345,25)\"></path><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(25,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(230.4770244885474,95.2828773266892)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(388.11865466122697,79.28982166771702)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(318.7118799141134,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(484.72956018247123,196.9889205007917)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(164.94211131215914,118.24407805299974)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(373.18091427323213,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(369.2807119739698,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(549.5562907505863,170.0676940013512)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(197.54187212485442,34.73572441017928)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(437.07921330087373,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(253.13455129411585,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(543.2282210295754,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(305.1222859501996,64.24834046105026)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(352.47303545031644,150.97556304101383)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(410.64745637525374,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(257.4598647525662,170.5509239070662)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(453.73123861393475,124.0183711562202)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(77.5886526052345,25)\" style=\"font-size: 15px;\"></text></svg></div>\n\n <link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/stylesheets/factorgraph/fg.css\">\n\n<script type=\"text/javascript\">\n             var fgScriptLocation;\n             if (typeof fgScriptLocation === 'undefined') {\n                fgScriptLocation = \"/assets/javascripts/factorgraph/fg.js\";\n                head.js(fgScriptLocation);\n             }\n             head.ready(function() {\n                var fgData = {\"width\": 650,\n                              \"height\": 250,\n                              \"graph\": {\"nodes\": [{\"x\": 107.00472824676606,\n                                                   \"y\": 394.2550154060314,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 208.0503344971993,\n                                                   \"y\": 97.36319059422512,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 21.41676845075231,\n                                                   \"y\": 2.819596515559608,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 193.26295294922426,\n                                                   \"y\": 228.79781661813965,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 556.0739052891971,\n                                                   \"y\": 188.8316858715553,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(0)), SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(1)), SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(2)), SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('word,Vector(ISeq(4)(I,love,Wolfe,.)((0 until 4)(3)), SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(0)), SeqAtom(_hidden,(0 until 4 - 1)(0) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(1)), SeqAtom(_hidden,(0 until 4 - 1)(1) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(2)), SeqAtom(_hidden,(0 until 4 - 1)(2) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 2)(0)), SeqAtom(_hidden,(0 until 4 - 2)(0) + 2)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.029289321881345254,NaN,NaN,0.0,0.0,NaN,NaN,-0.05527864045000421,0.1,NaN,0.0,0.0,0.0,0.0,-0.1,0.0,-0.1,0.0,0.1,0.1,NaN,0.0,0.0,0.0,0.1,0.1,NaN,0.0,NaN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 2)(1)), SeqAtom(_hidden,(0 until 4 - 2)(1) + 2)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"log(I(LengthAtom(_hidden) === 4))\"}],\n                                        \"links\": [{\"target\": 1, \"source\": 5},\n                                                  {\"target\": 2, \"source\": 6},\n                                                  {\"target\": 3, \"source\": 7},\n                                                  {\"target\": 4, \"source\": 8},\n                                                  {\"target\": 1, \"source\": 9},\n                                                  {\"target\": 2, \"source\": 10},\n                                                  {\"target\": 3, \"source\": 11},\n                                                  {\"target\": 4, \"source\": 12},\n                                                  {\"target\": 1, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 15},\n                                                  {\"target\": 4, \"source\": 15},\n                                                  {\"target\": 1, \"source\": 16},\n                                                  {\"target\": 3, \"source\": 16},\n                                                  {\"target\": 2, \"source\": 17},\n                                                  {\"target\": 4, \"source\": 17},\n                                                  {\"target\": 0, \"source\": 18}]},\n                              \"schedule\": [[{\"edge\": 0,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 0,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>-0.029289321881345254</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>-0.1</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 15,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 15,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 16,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 17,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 16,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 17,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>WOLFE</td><td>NaN</td></tr><tr><td>omg</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 18,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 18,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr></table>\"}]]};\n                FG.create(\"fg-4004503029736365988\", fgData);\n             });\n    </script></div>"
    }
  } ],
  "config" : { }
}
