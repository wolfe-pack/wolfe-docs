{
  "name" : "Chunking with CRFs",
  "cells" : [ {
    "id" : 0,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "val train = CoNLL2000.train.take(2).toSeq\nval labels = train.flatMap(_._2).distinct\nval words = train.flatMap(_._1).distinct\nwords.take(10)\n\n",
      "extraFields" : {
        "aggregatedCells" : "[]"
      },
      "outputFormat" : "<div class=\"string-result\"><div class=\"asIterable List\"><span class=\"typeName\">List</span>\n<ol start=\"0\" class=\"fields\">\n  <li class=\"fieldValue\"><span class=\"asString String\">Confidence</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">in</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">the</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">pound</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">is</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">widely</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">expected</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">to</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">take</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">another</span></li>\n</ol>\n</div></div>"
    }
  }, {
    "id" : 1,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "import ml.wolfe.term.LearningObjective._\n\nval maxLength = train.map(_._2.length).max\nval maxFeats = 20000\n\nimplicit val Thetas = Vectors(maxFeats)\nimplicit val Labels = labels.toDom\nimplicit val Words = words.toDom withOOV \"[OOV]\"\n\nimplicit val Inputs = Seqs(Words, 0, maxLength)\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\nimplicit val Instances = Pairs(Inputs, Outputs)\nimplicit val index = new SimpleIndex()\n\nval mpParams = MaxProductParameters(iterations = 1)\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\n\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x(i), y(i))\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\n\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.length)(i => t dot bias(y, i)) +\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.length - 1)(i => t dot pair(y, i))\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\nval test = IndexedSeq(\"This\", \"is\", \"a\", \"test\")\n\ndef predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\nval result = predict(Inputs.Const(test)).evalResult()\nD3FG.display(result.factorGraphs.head)",
      "extraFields" : {
        "aggregatedCells" : "[\"val train = CoNLL2000.train.take(2).toSeq\\nval labels = train.flatMap(_._2).distinct\\nval words = train.flatMap(_._1).distinct\\nwords.take(10)\\n\\n\"]"
      },
      "outputFormat" : "<div class=\"string-result\"><div id=\"fg104319942299683676\"><div class=\"playbtn\">Play</div><svg class=\"factorgraph\" width=\"650\" height=\"250\" style=\"overflow: visible;\"><defs><marker id=\"markerArrow0\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow1\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow2\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow3\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow4\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow5\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow6\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow7\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow8\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow9\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow10\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow11\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow12\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow13\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker><marker id=\"markerArrow14\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\"></path></marker></defs><line class=\"link\" x1=\"279.43262505701057\" y1=\"225\" x2=\"348.8817986605608\" y2=\"225\"></line><line class=\"link\" x1=\"497.17835882850494\" y1=\"223.38084544460733\" x2=\"457.2505449278222\" y2=\"166.42722870885285\"></line><line class=\"link\" x1=\"412.50565451956277\" y1=\"25\" x2=\"363.5975011100856\" y2=\"25\"></line><line class=\"link\" x1=\"183.68574049795828\" y1=\"70.90227900732465\" x2=\"225.40721252890688\" y2=\"25\"></line><line class=\"link\" x1=\"298.81722458109016\" y1=\"196.3282785981091\" x2=\"348.8817986605608\" y2=\"225\"></line><line class=\"link\" x1=\"524.7781188403535\" y1=\"156.80353079697386\" x2=\"457.2505449278222\" y2=\"166.42722870885285\"></line><line class=\"link\" x1=\"441.18979286324543\" y1=\"25\" x2=\"363.5975011100856\" y2=\"25\"></line><line class=\"link\" x1=\"160.21182691394475\" y1=\"25\" x2=\"225.40721252890688\" y2=\"25\"></line><line class=\"link\" x1=\"415.3494603941382\" y1=\"225\" x2=\"348.8817986605608\" y2=\"225\"></line><line class=\"link\" x1=\"415.3494603941382\" y1=\"225\" x2=\"457.2505449278222\" y2=\"166.42722870885285\"></line><line class=\"link\" x1=\"413.22858362788435\" y1=\"96.27864820812702\" x2=\"457.2505449278222\" y2=\"166.42722870885285\"></line><line class=\"link\" x1=\"413.22858362788435\" y1=\"96.27864820812702\" x2=\"363.5975011100856\" y2=\"25\"></line><line class=\"link\" x1=\"293.55428889796315\" y1=\"25\" x2=\"363.5975011100856\" y2=\"25\"></line><line class=\"link\" x1=\"293.55428889796315\" y1=\"25\" x2=\"225.40721252890688\" y2=\"25\"></line><line class=\"link\" x1=\"71.29538470500395\" y1=\"225\" x2=\"41.60443448212936\" y2=\"173.90352797714542\"></line><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(41.60443448212936,173.90352797714542)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(348.8817986605608,225)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(457.2505449278222,166.42722870885285)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(363.5975011100856,25)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(225.40721252890688,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(279.43262505701057,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(497.17835882850494,223.38084544460733)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(412.50565451956277,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(183.68574049795828,70.90227900732465)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(298.81722458109016,196.3282785981091)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(524.7781188403535,156.80353079697386)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(441.18979286324543,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(160.21182691394475,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(415.3494603941382,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(413.22858362788435,96.27864820812702)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(293.55428889796315,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(71.29538470500395,225)\"></path><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(41.60443448212936,173.90352797714542)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(348.8817986605608,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(457.2505449278222,166.42722870885285)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(363.5975011100856,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(225.40721252890688,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(279.43262505701057,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(497.17835882850494,223.38084544460733)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(412.50565451956277,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(183.68574049795828,70.90227900732465)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(298.81722458109016,196.3282785981091)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(524.7781188403535,156.80353079697386)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(441.18979286324543,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(160.21182691394475,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(415.3494603941382,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(413.22858362788435,96.27864820812702)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(293.55428889796315,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(71.29538470500395,225)\" style=\"font-size: 15px;\"></text></svg></div>\n\n <link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/stylesheets/factorgraph/fg.css\">\n\n<script type=\"text/javascript\">\n             var fgScriptLocation;\n             if (typeof fgScriptLocation === 'undefined') {\n                fgScriptLocation = \"/assets/javascripts/factorgraph/fg.js\";\n                head.js(fgScriptLocation);\n             }\n             head.ready(function() {\n                var fgData = {\"width\": 650,\n                              \"height\": 250,\n                              \"graph\": {\"nodes\": [{\"x\": 322.59369513402373,\n                                                   \"y\": 351.7948005515857,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>-Infinity</td></tr><tr><td>6</td><td>-Infinity</td></tr><tr><td>7</td><td>-Infinity</td></tr><tr><td>8</td><td>-Infinity</td></tr><tr><td>9</td><td>-Infinity</td></tr><tr><td>10</td><td>-Infinity</td></tr><tr><td>11</td><td>-Infinity</td></tr><tr><td>12</td><td>-Infinity</td></tr><tr><td>13</td><td>-Infinity</td></tr><tr><td>14</td><td>-Infinity</td></tr><tr><td>15</td><td>-Infinity</td></tr><tr><td>16</td><td>-Infinity</td></tr><tr><td>17</td><td>-Infinity</td></tr><tr><td>18</td><td>-Infinity</td></tr><tr><td>19</td><td>-Infinity</td></tr><tr><td>20</td><td>-Infinity</td></tr><tr><td>21</td><td>-Infinity</td></tr><tr><td>22</td><td>-Infinity</td></tr><tr><td>23</td><td>-Infinity</td></tr><tr><td>24</td><td>-Infinity</td></tr><tr><td>25</td><td>-Infinity</td></tr><tr><td>26</td><td>-Infinity</td></tr><tr><td>27</td><td>-Infinity</td></tr><tr><td>28</td><td>-Infinity</td></tr><tr><td>29</td><td>-Infinity</td></tr><tr><td>30</td><td>-Infinity</td></tr><tr><td>31</td><td>-Infinity</td></tr><tr><td>32</td><td>-Infinity</td></tr><tr><td>33</td><td>-Infinity</td></tr><tr><td>34</td><td>-Infinity</td></tr><tr><td>35</td><td>-Infinity</td></tr><tr><td>36</td><td>-Infinity</td></tr><tr><td>37</td><td>-Infinity</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 362.5838515684163,\n                                                   \"y\": 144.75605940043224,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 448.74646877611696,\n                                                   \"y\": 234.01958214308993,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 519.7857998306065,\n                                                   \"y\": 65.59794615361545,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 62.577362061016785,\n                                                   \"y\": 22.048593385364825,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(0)), SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(1)), SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(2)), SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(3)), SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(0)), SeqAtom(_hidden,(0 until 4 - 1)(0) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(1)), SeqAtom(_hidden,(0 until 4 - 1)(1) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(NaN,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1,0.15547001962252294,0.1,NaN,0.17071067811865476,NaN,0.1,0.1,0.1,0.1,0.1447213595499958,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,NaN,NaN,0.1,0.1,NaN,0.1,0.1,0.1,NaN,0.1,0.1,NaN,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1447213595499958,0.1447213595499958,0.1447213595499958,0.17071067811865476...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(2)), SeqAtom(_hidden,(0 until 4 - 1)(2) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"log(I(LengthAtom(_hidden) === 4))\"}],\n                                        \"links\": [{\"target\": 1, \"source\": 5},\n                                                  {\"target\": 2, \"source\": 6},\n                                                  {\"target\": 3, \"source\": 7},\n                                                  {\"target\": 4, \"source\": 8},\n                                                  {\"target\": 1, \"source\": 9},\n                                                  {\"target\": 2, \"source\": 10},\n                                                  {\"target\": 3, \"source\": 11},\n                                                  {\"target\": 4, \"source\": 12},\n                                                  {\"target\": 1, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 15},\n                                                  {\"target\": 4, \"source\": 15},\n                                                  {\"target\": 0, \"source\": 16}]},\n                              \"schedule\": [[{\"edge\": 0,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 0,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.17071067811865476</td></tr><tr><td>I-NP</td><td>0.17071067811865476</td></tr><tr><td>B-VP</td><td>0.1447213595499958</td></tr><tr><td>I-VP</td><td>0.1447213595499958</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.15547001962252294</td></tr><tr><td>B-ADJP</td><td>0.1</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.17071067811865476</td></tr><tr><td>I-NP</td><td>0.17071067811865476</td></tr><tr><td>B-VP</td><td>0.1447213595499958</td></tr><tr><td>I-VP</td><td>0.1447213595499958</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.15547001962252294</td></tr><tr><td>B-ADJP</td><td>0.1</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.17071067811865476</td></tr><tr><td>I-NP</td><td>0.17071067811865476</td></tr><tr><td>B-VP</td><td>0.1447213595499958</td></tr><tr><td>I-VP</td><td>0.1447213595499958</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.15547001962252294</td></tr><tr><td>B-ADJP</td><td>0.1</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.17071067811865476</td></tr><tr><td>I-NP</td><td>0.17071067811865476</td></tr><tr><td>B-VP</td><td>0.1447213595499958</td></tr><tr><td>I-VP</td><td>0.1447213595499958</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.15547001962252294</td></tr><tr><td>B-ADJP</td><td>0.1</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.1</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>NaN</td></tr><tr><td>B-PP</td><td>NaN</td></tr><tr><td>I-NP</td><td>NaN</td></tr><tr><td>B-VP</td><td>NaN</td></tr><tr><td>I-VP</td><td>NaN</td></tr><tr><td>B-SBAR</td><td>NaN</td></tr><tr><td>O</td><td>NaN</td></tr><tr><td>B-ADJP</td><td>NaN</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>-Infinity</td></tr><tr><td>6</td><td>-Infinity</td></tr><tr><td>7</td><td>-Infinity</td></tr><tr><td>8</td><td>-Infinity</td></tr><tr><td>9</td><td>-Infinity</td></tr><tr><td>10</td><td>-Infinity</td></tr><tr><td>11</td><td>-Infinity</td></tr><tr><td>12</td><td>-Infinity</td></tr><tr><td>13</td><td>-Infinity</td></tr><tr><td>14</td><td>-Infinity</td></tr><tr><td>15</td><td>-Infinity</td></tr><tr><td>16</td><td>-Infinity</td></tr><tr><td>17</td><td>-Infinity</td></tr><tr><td>18</td><td>-Infinity</td></tr><tr><td>19</td><td>-Infinity</td></tr><tr><td>20</td><td>-Infinity</td></tr><tr><td>21</td><td>-Infinity</td></tr><tr><td>22</td><td>-Infinity</td></tr><tr><td>23</td><td>-Infinity</td></tr><tr><td>24</td><td>-Infinity</td></tr><tr><td>25</td><td>-Infinity</td></tr><tr><td>26</td><td>-Infinity</td></tr><tr><td>27</td><td>-Infinity</td></tr><tr><td>28</td><td>-Infinity</td></tr><tr><td>29</td><td>-Infinity</td></tr><tr><td>30</td><td>-Infinity</td></tr><tr><td>31</td><td>-Infinity</td></tr><tr><td>32</td><td>-Infinity</td></tr><tr><td>33</td><td>-Infinity</td></tr><tr><td>34</td><td>-Infinity</td></tr><tr><td>35</td><td>-Infinity</td></tr><tr><td>36</td><td>-Infinity</td></tr><tr><td>37</td><td>-Infinity</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>-Infinity</td></tr><tr><td>6</td><td>-Infinity</td></tr><tr><td>7</td><td>-Infinity</td></tr><tr><td>8</td><td>-Infinity</td></tr><tr><td>9</td><td>-Infinity</td></tr><tr><td>10</td><td>-Infinity</td></tr><tr><td>11</td><td>-Infinity</td></tr><tr><td>12</td><td>-Infinity</td></tr><tr><td>13</td><td>-Infinity</td></tr><tr><td>14</td><td>-Infinity</td></tr><tr><td>15</td><td>-Infinity</td></tr><tr><td>16</td><td>-Infinity</td></tr><tr><td>17</td><td>-Infinity</td></tr><tr><td>18</td><td>-Infinity</td></tr><tr><td>19</td><td>-Infinity</td></tr><tr><td>20</td><td>-Infinity</td></tr><tr><td>21</td><td>-Infinity</td></tr><tr><td>22</td><td>-Infinity</td></tr><tr><td>23</td><td>-Infinity</td></tr><tr><td>24</td><td>-Infinity</td></tr><tr><td>25</td><td>-Infinity</td></tr><tr><td>26</td><td>-Infinity</td></tr><tr><td>27</td><td>-Infinity</td></tr><tr><td>28</td><td>-Infinity</td></tr><tr><td>29</td><td>-Infinity</td></tr><tr><td>30</td><td>-Infinity</td></tr><tr><td>31</td><td>-Infinity</td></tr><tr><td>32</td><td>-Infinity</td></tr><tr><td>33</td><td>-Infinity</td></tr><tr><td>34</td><td>-Infinity</td></tr><tr><td>35</td><td>-Infinity</td></tr><tr><td>36</td><td>-Infinity</td></tr><tr><td>37</td><td>-Infinity</td></tr></table>\"}]]};\n                FG.create(\"fg104319942299683676\", fgData);\n             });\n    </script></div>"
    }
  }, {
    "id" : 2,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "def skip(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+2))\ndef model2(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.length)(i => t dot bias(y, i)) +\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.length - 1)(i => t dot pair(y, i)) +\n    sum(0 until x.length - 2)(i => t dot skip(y, i))\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar2 = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model2(t))) using adaGrad(params)\n\ndef predict2(x:Inputs.Term) = argmax(Outputs)(model2(Thetas.Const(thetaStar))(x))\nval result2 = predict2(Inputs.Const(test)).evalResult()\nD3FG.display(result2.factorGraphs.head)\n",
      "extraFields" : {
        "aggregatedCells" : "[\"val train = CoNLL2000.train.take(2).toSeq\\nval labels = train.flatMap(_._2).distinct\\nval words = train.flatMap(_._1).distinct\\nwords.take(10)\\n\\n\",\"import ml.wolfe.term.LearningObjective._\\n\\nval maxLength = train.map(_._2.length).max\\nval maxFeats = 20000\\n\\nimplicit val Thetas = Vectors(maxFeats)\\nimplicit val Labels = labels.toDom\\nimplicit val Words = words.toDom withOOV \\\"[OOV]\\\"\\n\\nimplicit val Inputs = Seqs(Words, 0, maxLength)\\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\\nimplicit val Instances = Pairs(Inputs, Outputs)\\nimplicit val index = new SimpleIndex()\\n\\nval mpParams = MaxProductParameters(iterations = 1)\\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\\n\\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x(i), y(i))\\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\\n\\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\\n    sum(0 until x.length)(i => t dot bias(y, i)) +\\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\\n    sum(0 until x.length - 1)(i => t dot pair(y, i))\\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\\n\\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\\n\\nval test = IndexedSeq(\\\"This\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\")\\n//val thetaStar = feature('word, \\\"Wolfe\\\", \\\"WOLFE\\\")\\n\\ndef predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\\nval result = predict(Inputs.Const(test)).evalResult()\\nD3FG.display(result.factorGraphs.head)\\n\\n\"]"
      },
      "outputFormat" : "<div class=\"string-result\"><span class=\"label label-danger\">Error!</span>\n<pre class=\"error\"><console>:68: error: type mismatch;\n found   : Int(0)\n required: ?{def until: ?}\nNote that implicit conversions are not applicable because they are ambiguous:\n both method intWrapper in class LowPriorityImplicits of type (x: Int)scala.runtime.RichInt\n and method intToRichIntTerm in trait MathImplicits of type (int: Int)ml.wolfe.term.TermImplicits.RichIntTerm\n are possible conversion functions from Int(0) to ?{def until: ?}\n                  sum(0 until x.words.length)(i =&gt; t dot bias(y, i)) +\n                      ^\n<console>:78: error: value _1 is not a member of String\n                val result2 = predict2(Inputs.Const(test.head._1)).evalResult()\n                                                              ^\n</console></console></pre></div>"
    }
  } ],
  "config" : { }
}
