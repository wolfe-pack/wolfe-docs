{
  "name" : "Chunking with CRFs",
  "cells" : [ {
    "id" : 0,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "val train = CoNLL2000.train.take(2).toSeq\nval labels = train.flatMap(_._2).distinct\nval words = train.flatMap(_._1).distinct\nwords.take(10)",
      "extraFields" : {
        "aggregatedCells" : "[]"
      },
      "outputFormat" : "<div class=\"string-result\"><div class=\"asIterable List\"><span class=\"typeName\">List</span>\n<ol start=\"0\" class=\"fields\">\n  <li class=\"fieldValue\"><span class=\"asString String\">Confidence</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">in</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">the</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">pound</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">is</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">widely</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">expected</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">to</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">take</span></li>\n  <li class=\"fieldValue\"><span class=\"asString String\">another</span></li>\n</ol>\n</div></div>"
    }
  }, {
    "id" : 5,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "val maxLength = train.map(_._2.length).max\nval maxFeats = 20000\n\nimplicit val Thetas = Vectors(maxFeats)\nimplicit val Labels = labels.toDom\nimplicit val Words = words.toDom withOOV \"[OOV]\"\n\nimplicit val Inputs = Seqs(Words, 0, maxLength)\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\nimplicit val Instances = Pairs(Inputs, Outputs)\nimplicit val index = new SimpleIndex()\n\nval mpParams = MaxProductParameters(iterations = 1)\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\n\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x(i), y(i))\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\n\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.length)(i => t dot bias(y, i)) +\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.length - 1)(i => t dot pair(y, i))\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\nval test = IndexedSeq(\"This\", \"is\", \"a\", \"test\")\n\ndef predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\nval result = predict(Inputs.Const(test)).evalResult()\nresult.factorGraphs.head",
      "extraFields" : {
        "aggregatedCells" : "[\"val train = CoNLL2000.train.take(2).toSeq\\nval labels = train.flatMap(_._2).distinct\\nval words = train.flatMap(_._1).distinct\\nwords.take(10)\"]"
      },
      "outputFormat" : "<div class=\"string-result\"><div id=\"fg6881307992860747559\"><div class=\"playbtn\">Play</div><svg class=\"factorgraph\" width=\"650\" height=\"250\" style=\"overflow: visible;\"><defs><marker id=\"markerArrow0\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow1\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow2\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow3\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow4\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"5.289151702295592\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(-90)\"></path></marker><marker id=\"markerArrow5\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow6\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow7\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow8\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"33.798486404723185\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(-90)\"></path></marker><marker id=\"markerArrow9\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow10\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow11\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"37.150743677938465\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(-90)\"></path></marker><marker id=\"markerArrow12\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker><marker id=\"markerArrow13\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"33.20352162641636\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(-90)\"></path></marker><marker id=\"markerArrow14\" class=\"markerArrow\" markerWidth=\"100\" markerHeight=\"100\" refX=\"0\" orient=\"auto\"><path d=\"M0,-3.6042171212021317L4.161791450287818,3.6042171212021317 -4.161791450287818,3.6042171212021317Z\" fill=\"white\" transform=\"rotate(90)\"></path></marker></defs><line class=\"link\" x1=\"54.199624593274415\" y1=\"95.1925011289726\" x2=\"116.43818971203568\" y2=\"87.22523331893566\" marker-end=\"none\"></line><line class=\"link\" x1=\"255.92605537070938\" y1=\"225\" x2=\"227.4019002964278\" y2=\"165.9431678731361\" marker-end=\"none\"></line><line class=\"link\" x1=\"321.73694583742105\" y1=\"25\" x2=\"350.66737731924053\" y2=\"82.09293257814093\" marker-end=\"none\"></line><line class=\"link\" x1=\"471.5452218573919\" y1=\"225\" x2=\"450.9722480769669\" y2=\"171.3499052495927\" marker-end=\"none\"></line><line class=\"link\" x1=\"116.33789611853366\" y1=\"25\" x2=\"116.43818971203568\" y2=\"87.22523331893566\" marker-end=\"url(#markerArrow4)\"></line><line class=\"link\" x1=\"191.7289596298477\" y1=\"225\" x2=\"227.4019002964278\" y2=\"165.9431678731361\" marker-end=\"none\"></line><line class=\"link\" x1=\"388.5405349669963\" y1=\"25\" x2=\"350.66737731924053\" y2=\"82.09293257814093\" marker-end=\"none\"></line><line class=\"link\" x1=\"503.00378510804353\" y1=\"134.36784662410358\" x2=\"450.9722480769669\" y2=\"171.3499052495927\" marker-end=\"none\"></line><line class=\"link\" x1=\"165.77838535213806\" y1=\"133.43016625036037\" x2=\"116.43818971203568\" y2=\"87.22523331893566\" marker-end=\"none\"></line><line class=\"link\" x1=\"165.77838535213806\" y1=\"133.43016625036037\" x2=\"227.4019002964278\" y2=\"165.9431678731361\" marker-end=\"none\"></line><line class=\"link\" x1=\"289.48055551326667\" y1=\"124.24603282687164\" x2=\"227.4019002964278\" y2=\"165.9431678731361\" marker-end=\"none\"></line><line class=\"link\" x1=\"289.48055551326667\" y1=\"124.24603282687164\" x2=\"350.66737731924053\" y2=\"82.09293257814093\" marker-end=\"none\"></line><line class=\"link\" x1=\"406.4200318146427\" y1=\"122.10566274654781\" x2=\"350.66737731924053\" y2=\"82.09293257814093\" marker-end=\"none\"></line><line class=\"link\" x1=\"406.4200318146427\" y1=\"122.10566274654781\" x2=\"450.9722480769669\" y2=\"171.3499052495927\" marker-end=\"none\"></line><line class=\"link\" x1=\"625\" y1=\"134.94840897345645\" x2=\"621.6158192094804\" y2=\"197.34697784459934\" marker-end=\"none\"></line><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(621.6158192094804,197.34697784459934)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(116.43818971203568,87.22523331893566)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(227.4019002964278,165.9431678731361)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(350.66737731924053,82.09293257814093)\"></path><path class=\"fgshape fgnode\" d=\"M0,25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,-25.2313252202016A25.2313252202016,25.2313252202016 0 1,1 0,25.2313252202016Z\" transform=\"translate(450.9722480769669,171.3499052495927)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(54.199624593274415,95.1925011289726)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(255.92605537070938,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(321.73694583742105,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(471.5452218573919,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(116.33789611853366,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(191.7289596298477,225)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(388.5405349669963,25)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(503.00378510804353,134.36784662410358)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(165.77838535213806,133.43016625036037)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(289.48055551326667,124.24603282687164)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(406.4200318146427,122.10566274654781)\"></path><path class=\"fgshape fgfactor\" d=\"M-11.180339887498949,-11.180339887498949L11.180339887498949,-11.180339887498949 11.180339887498949,11.180339887498949 -11.180339887498949,11.180339887498949Z\" transform=\"translate(625,134.94840897345645)\"></path><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(621.6158192094804,197.34697784459934)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(116.43818971203568,87.22523331893566)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(227.4019002964278,165.9431678731361)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(350.66737731924053,82.09293257814093)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(450.9722480769669,171.3499052495927)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(54.199624593274415,95.1925011289726)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(255.92605537070938,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(321.73694583742105,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(471.5452218573919,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(116.33789611853366,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(191.7289596298477,225)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(388.5405349669963,25)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(503.00378510804353,134.36784662410358)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(165.77838535213806,133.43016625036037)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(289.48055551326667,124.24603282687164)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(406.4200318146427,122.10566274654781)\" style=\"font-size: 15px;\"></text><text class=\"label\" text-anchor=\"middle\" dy=\".35em\" transform=\"translate(625,134.94840897345645)\" style=\"font-size: 15px;\"></text><foreignObject class=\"tooltip\" width=\"350\" height=\"500\" style=\"opacity: 0;\" transform=\"translate(0,110.1925011289726)\"><div class=\"tooltipinner\">Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(0))),1.0)</div></foreignObject></svg></div>\n\n <link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/stylesheets/factorgraph/fg.css\">\n\n<script type=\"text/javascript\">\n             var fgScriptLocation;\n             if (typeof fgScriptLocation === 'undefined') {\n                fgScriptLocation = \"/assets/javascripts/factorgraph/fg.js\";\n                head.js(fgScriptLocation);\n             }\n             head.ready(function() {\n                var fgData = {\"width\": 650,\n                              \"height\": 250,\n                              \"graph\": {\"nodes\": [{\"x\": 587.4061564191013,\n                                                   \"y\": 9.019116302617025,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>-Infinity</td></tr><tr><td>6</td><td>-Infinity</td></tr><tr><td>7</td><td>-Infinity</td></tr><tr><td>8</td><td>-Infinity</td></tr><tr><td>9</td><td>-Infinity</td></tr><tr><td>10</td><td>-Infinity</td></tr><tr><td>11</td><td>-Infinity</td></tr><tr><td>12</td><td>-Infinity</td></tr><tr><td>13</td><td>-Infinity</td></tr><tr><td>14</td><td>-Infinity</td></tr><tr><td>15</td><td>-Infinity</td></tr><tr><td>16</td><td>-Infinity</td></tr><tr><td>17</td><td>-Infinity</td></tr><tr><td>18</td><td>-Infinity</td></tr><tr><td>19</td><td>-Infinity</td></tr><tr><td>20</td><td>-Infinity</td></tr><tr><td>21</td><td>-Infinity</td></tr><tr><td>22</td><td>-Infinity</td></tr><tr><td>23</td><td>-Infinity</td></tr><tr><td>24</td><td>-Infinity</td></tr><tr><td>25</td><td>-Infinity</td></tr><tr><td>26</td><td>-Infinity</td></tr><tr><td>27</td><td>-Infinity</td></tr><tr><td>28</td><td>-Infinity</td></tr><tr><td>29</td><td>-Infinity</td></tr><tr><td>30</td><td>-Infinity</td></tr><tr><td>31</td><td>-Infinity</td></tr><tr><td>32</td><td>-Infinity</td></tr><tr><td>33</td><td>-Infinity</td></tr><tr><td>34</td><td>-Infinity</td></tr><tr><td>35</td><td>-Infinity</td></tr><tr><td>36</td><td>-Infinity</td></tr><tr><td>37</td><td>-Infinity</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 34.26600235847628,\n                                                   \"y\": 315.146247498193,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>0.7108315911199761</td></tr><tr><td>B-PP</td><td>0.739278259626582</td></tr><tr><td>I-NP</td><td>0.7954130836091303</td></tr><tr><td>B-VP</td><td>0.6703033375729529</td></tr><tr><td>I-VP</td><td>0.6595546775004258</td></tr><tr><td>B-SBAR</td><td>0.7150246971229487</td></tr><tr><td>O</td><td>0.8150246971229487</td></tr><tr><td>B-ADJP</td><td>0.6736033408856392</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 76.46061446072821,\n                                                   \"y\": 202.6462268382302,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.544314019004294</td></tr><tr><td>B-PP</td><td>0.8150246971229487</td></tr><tr><td>I-NP</td><td>0.7255585890230197</td></tr><tr><td>B-VP</td><td>0.6599205894398192</td></tr><tr><td>I-VP</td><td>0.6335653589317669</td></tr><tr><td>B-SBAR</td><td>0.7004488429868423</td></tr><tr><td>O</td><td>0.5727606875108999</td></tr><tr><td>B-ADJP</td><td>0.48283220626632384</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 317.3625684513649,\n                                                   \"y\": 357.98846634167325,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.8150246971229487</td></tr><tr><td>B-PP</td><td>0.5841741519434525</td></tr><tr><td>I-NP</td><td>0.5403089759260007</td></tr><tr><td>B-VP</td><td>0.5151992298898234</td></tr><tr><td>I-VP</td><td>0.5597292102673004</td></tr><tr><td>B-SBAR</td><td>0.5599205894398191</td></tr><tr><td>O</td><td>0.6599205894398192</td></tr><tr><td>B-ADJP</td><td>0.4184992332025096</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"x\": 429.7987957212612,\n                                                   \"y\": 106.97035985264223,\n                                                   \"hoverhtml\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>0.5557274834368465</td></tr><tr><td>B-PP</td><td>0.8150246971229488</td></tr><tr><td>I-NP</td><td>0.7711595211054971</td></tr><tr><td>B-VP</td><td>0.5753390969506649</td></tr><tr><td>I-VP</td><td>0.5645904368781378</td></tr><tr><td>B-SBAR</td><td>0.6200604565006607</td></tr><tr><td>O</td><td>0.7200604565006606</td></tr><tr><td>B-ADJP</td><td>0.5493497783820059</td></tr></table>\",\n                                                   \"text\": \"\",\n                                                   \"fixed\": false,\n                                                   \"type\": \"node\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('bias,Vector(SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(0)), SeqAtom(_hidden,(0 until 4)(0))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(1)), SeqAtom(_hidden,(0 until 4)(1))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(2)), SeqAtom(_hidden,(0 until 4)(2))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('word,Vector(ISeq(4)(This,is,a,test)((0 until 4)(3)), SeqAtom(_hidden,(0 until 4)(3))),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(0)), SeqAtom(_hidden,(0 until 4 - 1)(0) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(1)), SeqAtom(_hidden,(0 until 4 - 1)(1) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"Tensor1(-0.07490378412162739,0.1242535625036333,0.0803883864861816,0.05527864045000421,0.04452998037747709,0.1,0.1,0.029289321881345254,0.0,0.17071067811865476,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.0,0.1,0.1,0.0,0.1,0.1,0.0,0.0,0.1,0.1,0.1,0.1,0.1,0.1,0.0,0.1,0.1,0.1,0.1,0.1,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.17071067811865476,0.1,0.05527864045000421,0.04000000000000001,0.1447213595499958,0.05527864045000421...) dot Feature('pair,Vector(SeqAtom(_hidden,(0 until 4 - 1)(2)), SeqAtom(_hidden,(0 until 4 - 1)(2) + 1)),1.0)\"},\n                                                  {\"type\": \"factor\",\n                                                   \"hoverhtml\": \"log(I(LengthAtom(_hidden) === 4))\"}],\n                                        \"links\": [{\"target\": 1, \"source\": 5},\n                                                  {\"target\": 2, \"source\": 6},\n                                                  {\"target\": 3, \"source\": 7},\n                                                  {\"target\": 4, \"source\": 8},\n                                                  {\"target\": 1, \"source\": 9},\n                                                  {\"target\": 2, \"source\": 10},\n                                                  {\"target\": 3, \"source\": 11},\n                                                  {\"target\": 4, \"source\": 12},\n                                                  {\"target\": 1, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 13},\n                                                  {\"target\": 2, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 14},\n                                                  {\"target\": 3, \"source\": 15},\n                                                  {\"target\": 4, \"source\": 15},\n                                                  {\"target\": 0, \"source\": 16}]},\n                              \"schedule\": [[{\"edge\": 14,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>-Infinity</td></tr><tr><td>1</td><td>-Infinity</td></tr><tr><td>2</td><td>-Infinity</td></tr><tr><td>3</td><td>-Infinity</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>-Infinity</td></tr><tr><td>6</td><td>-Infinity</td></tr><tr><td>7</td><td>-Infinity</td></tr><tr><td>8</td><td>-Infinity</td></tr><tr><td>9</td><td>-Infinity</td></tr><tr><td>10</td><td>-Infinity</td></tr><tr><td>11</td><td>-Infinity</td></tr><tr><td>12</td><td>-Infinity</td></tr><tr><td>13</td><td>-Infinity</td></tr><tr><td>14</td><td>-Infinity</td></tr><tr><td>15</td><td>-Infinity</td></tr><tr><td>16</td><td>-Infinity</td></tr><tr><td>17</td><td>-Infinity</td></tr><tr><td>18</td><td>-Infinity</td></tr><tr><td>19</td><td>-Infinity</td></tr><tr><td>20</td><td>-Infinity</td></tr><tr><td>21</td><td>-Infinity</td></tr><tr><td>22</td><td>-Infinity</td></tr><tr><td>23</td><td>-Infinity</td></tr><tr><td>24</td><td>-Infinity</td></tr><tr><td>25</td><td>-Infinity</td></tr><tr><td>26</td><td>-Infinity</td></tr><tr><td>27</td><td>-Infinity</td></tr><tr><td>28</td><td>-Infinity</td></tr><tr><td>29</td><td>-Infinity</td></tr><tr><td>30</td><td>-Infinity</td></tr><tr><td>31</td><td>-Infinity</td></tr><tr><td>32</td><td>-Infinity</td></tr><tr><td>33</td><td>-Infinity</td></tr><tr><td>34</td><td>-Infinity</td></tr><tr><td>35</td><td>-Infinity</td></tr><tr><td>36</td><td>-Infinity</td></tr><tr><td>37</td><td>-Infinity</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>0.0</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.1</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>-0.1</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>-0.1</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.29496424062228804</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.22425356250363332</td></tr><tr><td>B-VP</td><td>0.1242535625036333</td></tr><tr><td>I-VP</td><td>0.1242535625036333</td></tr><tr><td>B-SBAR</td><td>0.1242535625036333</td></tr><tr><td>O</td><td>0.22425356250363332</td></tr><tr><td>B-ADJP</td><td>0.15354288438497854</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.1</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.1</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.3200604565006607</td></tr><tr><td>B-PP</td><td>0.2485071250072666</td></tr><tr><td>I-NP</td><td>0.20464194898981491</td></tr><tr><td>B-VP</td><td>0.1795322029536375</td></tr><tr><td>I-VP</td><td>0.1687835428811104</td></tr><tr><td>B-SBAR</td><td>0.22425356250363332</td></tr><tr><td>O</td><td>0.32425356250363335</td></tr><tr><td>B-ADJP</td><td>0.08283220626632379</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.42425356250363333</td></tr><tr><td>B-PP</td><td>0.49077113461931543</td></tr><tr><td>I-NP</td><td>0.5095031756006523</td></tr><tr><td>B-VP</td><td>0.32425356250363335</td></tr><tr><td>I-VP</td><td>0.4647818160506565</td></tr><tr><td>B-SBAR</td><td>0.4200604565006607</td></tr><tr><td>O</td><td>0.3485071250072666</td></tr><tr><td>B-ADJP</td><td>0.32425356250363335</td></tr></table>\"}],\n                                           [{\"edge\": 0,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>0.0</td></tr><tr><td>B-PP</td><td>0.0</td></tr><tr><td>I-NP</td><td>0.0</td></tr><tr><td>B-VP</td><td>0.0</td></tr><tr><td>I-VP</td><td>0.0</td></tr><tr><td>B-SBAR</td><td>0.0</td></tr><tr><td>O</td><td>0.0</td></tr><tr><td>B-ADJP</td><td>0.0</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.24934977838200595</td></tr><tr><td>B-PP</td><td>0.6150246971229487</td></tr><tr><td>I-NP</td><td>0.5898915620868339</td></tr><tr><td>B-VP</td><td>0.4795322029536376</td></tr><tr><td>I-VP</td><td>0.5093117964281336</td></tr><tr><td>B-SBAR</td><td>0.5200604565006607</td></tr><tr><td>O</td><td>0.44850712500726664</td></tr><tr><td>B-ADJP</td><td>0.3535428843849786</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>0.7857353752416034</td></tr><tr><td>B-PP</td><td>0.6150246971229487</td></tr><tr><td>I-NP</td><td>0.7150246971229487</td></tr><tr><td>B-VP</td><td>0.6150246971229487</td></tr><tr><td>I-VP</td><td>0.6150246971229487</td></tr><tr><td>B-SBAR</td><td>0.6150246971229487</td></tr><tr><td>O</td><td>0.7150246971229487</td></tr><tr><td>B-ADJP</td><td>0.644314019004294</td></tr></table>\"}],\n                                           [{\"edge\": 8,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>-0.07490378412162739</td></tr><tr><td>B-PP</td><td>0.1242535625036333</td></tr><tr><td>I-NP</td><td>0.0803883864861816</td></tr><tr><td>B-VP</td><td>0.05527864045000421</td></tr><tr><td>I-VP</td><td>0.04452998037747709</td></tr><tr><td>B-SBAR</td><td>0.1</td></tr><tr><td>O</td><td>0.1</td></tr><tr><td>B-ADJP</td><td>0.029289321881345254</td></tr></table>\"}],\n                                           [{\"edge\": 9,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.29496424062228804</td></tr><tr><td>B-PP</td><td>0.2</td></tr><tr><td>I-NP</td><td>0.13566702693618582</td></tr><tr><td>B-VP</td><td>0.1803883864861816</td></tr><tr><td>I-VP</td><td>0.1242535625036333</td></tr><tr><td>B-SBAR</td><td>0.1803883864861816</td></tr><tr><td>O</td><td>0.1242535625036333</td></tr><tr><td>B-ADJP</td><td>0.12928932188134526</td></tr></table>\"}],\n                                           [{\"edge\": 4,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>0.7108315911199761</td></tr><tr><td>B-PP</td><td>0.739278259626582</td></tr><tr><td>I-NP</td><td>0.7954130836091303</td></tr><tr><td>B-VP</td><td>0.6703033375729529</td></tr><tr><td>I-VP</td><td>0.6595546775004258</td></tr><tr><td>B-SBAR</td><td>0.7150246971229487</td></tr><tr><td>O</td><td>0.8150246971229487</td></tr><tr><td>B-ADJP</td><td>0.6736033408856392</td></tr></table>\"}],\n                                           [{\"edge\": 0,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,0)</i></td><td></td></tr><tr><td>B-NP</td><td>0.7857353752416034</td></tr><tr><td>B-PP</td><td>0.6150246971229487</td></tr><tr><td>I-NP</td><td>0.7150246971229487</td></tr><tr><td>B-VP</td><td>0.6150246971229487</td></tr><tr><td>I-VP</td><td>0.6150246971229487</td></tr><tr><td>B-SBAR</td><td>0.6150246971229487</td></tr><tr><td>O</td><td>0.7150246971229487</td></tr><tr><td>B-ADJP</td><td>0.644314019004294</td></tr></table>\"}],\n                                           [{\"edge\": 10,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.12006045650066066</td></tr><tr><td>B-PP</td><td>0.3242535625036333</td></tr><tr><td>I-NP</td><td>0.21605541342236742</td></tr><tr><td>B-VP</td><td>0.33566702693618583</td></tr><tr><td>I-VP</td><td>0.1687835428811104</td></tr><tr><td>B-SBAR</td><td>0.2803883864861816</td></tr><tr><td>O</td><td>0.22425356250363332</td></tr><tr><td>B-ADJP</td><td>0.1585786437626905</td></tr></table>\"}],\n                                           [{\"edge\": 11,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.49496424062228805</td></tr><tr><td>B-PP</td><td>0.33566702693618583</td></tr><tr><td>I-NP</td><td>0.33566702693618583</td></tr><tr><td>B-VP</td><td>0.33566702693618583</td></tr><tr><td>I-VP</td><td>0.39094566738619</td></tr><tr><td>B-SBAR</td><td>0.33566702693618583</td></tr><tr><td>O</td><td>0.33566702693618583</td></tr><tr><td>B-ADJP</td><td>0.33566702693618583</td></tr></table>\"}],\n                                           [{\"edge\": 5,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.644314019004294</td></tr><tr><td>B-PP</td><td>0.8150246971229487</td></tr><tr><td>I-NP</td><td>0.7255585890230197</td></tr><tr><td>B-VP</td><td>0.5599205894398191</td></tr><tr><td>I-VP</td><td>0.6335653589317669</td></tr><tr><td>B-SBAR</td><td>0.7004488429868423</td></tr><tr><td>O</td><td>0.5727606875108999</td></tr><tr><td>B-ADJP</td><td>0.48283220626632384</td></tr></table>\"}],\n                                           [{\"edge\": 1,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,1)</i></td><td></td></tr><tr><td>B-NP</td><td>0.6192178031259213</td></tr><tr><td>B-PP</td><td>0.6907711346193155</td></tr><tr><td>I-NP</td><td>0.6451702025368381</td></tr><tr><td>B-VP</td><td>0.6046419489898149</td></tr><tr><td>I-VP</td><td>0.5890353785542898</td></tr><tr><td>B-SBAR</td><td>0.6004488429868423</td></tr><tr><td>O</td><td>0.4727606875108999</td></tr><tr><td>B-ADJP</td><td>0.4535428843849786</td></tr></table>\"}],\n                                           [{\"edge\": 12,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.5200604565006607</td></tr><tr><td>B-PP</td><td>0.4599205894398191</td></tr><tr><td>I-NP</td><td>0.3160554134223674</td></tr><tr><td>B-VP</td><td>0.39094566738619</td></tr><tr><td>I-VP</td><td>0.4354756477636671</td></tr><tr><td>B-SBAR</td><td>0.43566702693618586</td></tr><tr><td>O</td><td>0.43566702693618586</td></tr><tr><td>B-ADJP</td><td>0.26495634881753105</td></tr></table>\"}],\n                                           [{\"edge\": 13,\n                                             \"direction\": \"F2N\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>0.6306312675584739</td></tr><tr><td>B-PP</td><td>0.6907711346193155</td></tr><tr><td>I-NP</td><td>0.6907711346193155</td></tr><tr><td>B-VP</td><td>0.5200604565006607</td></tr><tr><td>I-VP</td><td>0.5200604565006607</td></tr><tr><td>B-SBAR</td><td>0.5200604565006607</td></tr><tr><td>O</td><td>0.6200604565006607</td></tr><tr><td>B-ADJP</td><td>0.5200604565006607</td></tr></table>\"}],\n                                           [{\"edge\": 6,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.7150246971229487</td></tr><tr><td>B-PP</td><td>0.5841741519434525</td></tr><tr><td>I-NP</td><td>0.6403089759260008</td></tr><tr><td>B-VP</td><td>0.5151992298898234</td></tr><tr><td>I-VP</td><td>0.5597292102673004</td></tr><tr><td>B-SBAR</td><td>0.5599205894398191</td></tr><tr><td>O</td><td>0.6599205894398192</td></tr><tr><td>B-ADJP</td><td>0.5184992332025096</td></tr></table>\"}],\n                                           [{\"edge\": 2,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,2)</i></td><td></td></tr><tr><td>B-NP</td><td>0.889928481244576</td></tr><tr><td>B-PP</td><td>0.4599205894398191</td></tr><tr><td>I-NP</td><td>0.45992058943981917</td></tr><tr><td>B-VP</td><td>0.4599205894398191</td></tr><tr><td>I-VP</td><td>0.5151992298898234</td></tr><tr><td>B-SBAR</td><td>0.4599205894398191</td></tr><tr><td>O</td><td>0.5599205894398191</td></tr><tr><td>B-ADJP</td><td>0.38920991132116434</td></tr></table>\"}],\n                                           [{\"edge\": 7,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>0.5557274834368465</td></tr><tr><td>B-PP</td><td>0.8150246971229488</td></tr><tr><td>I-NP</td><td>0.7711595211054971</td></tr><tr><td>B-VP</td><td>0.5753390969506649</td></tr><tr><td>I-VP</td><td>0.5645904368781378</td></tr><tr><td>B-SBAR</td><td>0.6200604565006607</td></tr><tr><td>O</td><td>0.7200604565006606</td></tr><tr><td>B-ADJP</td><td>0.5493497783820059</td></tr></table>\"}],\n                                           [{\"edge\": 3,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>SeqGroundAtom(_hidden,3)</i></td><td></td></tr><tr><td>B-NP</td><td>0.6306312675584739</td></tr><tr><td>B-PP</td><td>0.6907711346193155</td></tr><tr><td>I-NP</td><td>0.6907711346193155</td></tr><tr><td>B-VP</td><td>0.5200604565006607</td></tr><tr><td>I-VP</td><td>0.5200604565006607</td></tr><tr><td>B-SBAR</td><td>0.5200604565006607</td></tr><tr><td>O</td><td>0.6200604565006607</td></tr><tr><td>B-ADJP</td><td>0.5200604565006607</td></tr></table>\"}],\n                                           [{\"edge\": 14,\n                                             \"direction\": \"N2F\",\n                                             \"msg\": \"<table class='potentialtable'><tr><td><i>LengthGroundAtom(_hidden)</i></td><td></td></tr><tr><td>0</td><td>0.0</td></tr><tr><td>1</td><td>0.0</td></tr><tr><td>2</td><td>0.0</td></tr><tr><td>3</td><td>0.0</td></tr><tr><td>4</td><td>0.0</td></tr><tr><td>5</td><td>0.0</td></tr><tr><td>6</td><td>0.0</td></tr><tr><td>7</td><td>0.0</td></tr><tr><td>8</td><td>0.0</td></tr><tr><td>9</td><td>0.0</td></tr><tr><td>10</td><td>0.0</td></tr><tr><td>11</td><td>0.0</td></tr><tr><td>12</td><td>0.0</td></tr><tr><td>13</td><td>0.0</td></tr><tr><td>14</td><td>0.0</td></tr><tr><td>15</td><td>0.0</td></tr><tr><td>16</td><td>0.0</td></tr><tr><td>17</td><td>0.0</td></tr><tr><td>18</td><td>0.0</td></tr><tr><td>19</td><td>0.0</td></tr><tr><td>20</td><td>0.0</td></tr><tr><td>21</td><td>0.0</td></tr><tr><td>22</td><td>0.0</td></tr><tr><td>23</td><td>0.0</td></tr><tr><td>24</td><td>0.0</td></tr><tr><td>25</td><td>0.0</td></tr><tr><td>26</td><td>0.0</td></tr><tr><td>27</td><td>0.0</td></tr><tr><td>28</td><td>0.0</td></tr><tr><td>29</td><td>0.0</td></tr><tr><td>30</td><td>0.0</td></tr><tr><td>31</td><td>0.0</td></tr><tr><td>32</td><td>0.0</td></tr><tr><td>33</td><td>0.0</td></tr><tr><td>34</td><td>0.0</td></tr><tr><td>35</td><td>0.0</td></tr><tr><td>36</td><td>0.0</td></tr><tr><td>37</td><td>0.0</td></tr></table>\"}]]};\n                FG.create(\"fg6881307992860747559\", fgData);\n             });\n    </script></div>"
    }
  }, {
    "id" : 2,
    "compiler" : "scala",
    "input" : {
      "sessionId" : null,
      "code" : "def skip(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+2))\ndef model2(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\n    sum(0 until x.length)(i => t dot bias(y, i)) +\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\n    sum(0 until x.length - 1)(i => t dot pair(y, i)) +\n    sum(0 until x.length - 2)(i => t dot skip(y, i))\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\n\nval thetaStar2 = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model2(t))) using adaGrad(params)\n\ndef predict2(x:Inputs.Term) = argmax(Outputs)(model2(Thetas.Const(thetaStar))(x))\nval result2 = predict2(Inputs.Const(test)).evalResult()\nresult2.factorGraphs.head\n",
      "extraFields" : {
        "aggregatedCells" : "[\"val train = CoNLL2000.train.take(2).toSeq\\nval labels = train.flatMap(_._2).distinct\\nval words = train.flatMap(_._1).distinct\\nwords.take(10)\\n\\n\",\"import ml.wolfe.term.LearningObjective._\\n\\nval maxLength = train.map(_._2.length).max\\nval maxFeats = 20000\\n\\nimplicit val Thetas = Vectors(maxFeats)\\nimplicit val Labels = labels.toDom\\nimplicit val Words = words.toDom withOOV \\\"[OOV]\\\"\\n\\nimplicit val Inputs = Seqs(Words, 0, maxLength)\\nimplicit val Outputs = Seqs(Labels, 0, maxLength)\\nimplicit val Instances = Pairs(Inputs, Outputs)\\nimplicit val index = new SimpleIndex()\\n\\nval mpParams = MaxProductParameters(iterations = 1)\\nval params = AdaGradParameters(epochs = 1, learningRate = 0.1)\\n\\ndef bias(y: Outputs.Term, i:IntTerm) = feature('bias, y(i))\\ndef word(x:Inputs.Term, y: Outputs.Term, i:IntTerm) = feature('word, x(i), y(i))\\ndef pair(y: Outputs.Term, i:IntTerm) = feature('pair, y(i), y(i+1))\\n\\ndef model(t: Thetas.Term)(x: Inputs.Term)(y: Outputs.Term) = {\\n    sum(0 until x.length)(i => t dot bias(y, i)) +\\n    sum(0 until x.length)(i => t dot word(x, y, i)) +\\n    sum(0 until x.length - 1)(i => t dot pair(y, i))\\n} subjectTo (y.length === x.length) argmaxBy maxProduct(mpParams)\\n\\nval thetaStar = learn(Thetas)(t => perceptron(train.toConst)(Outputs)(model(t))) using adaGrad(params)\\n\\nval test = IndexedSeq(\\\"This\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\")\\n//val thetaStar = feature('word, \\\"Wolfe\\\", \\\"WOLFE\\\")\\n\\ndef predict(x:Inputs.Term) = argmax(Outputs)(model(Thetas.Const(thetaStar))(x))\\nval result = predict(Inputs.Const(test)).evalResult()\\nD3FG.display(result.factorGraphs.head)\\n\\n\"]"
      },
      "outputFormat" : ""
    }
  } ],
  "config" : { }
}
